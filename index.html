<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/heart.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IndiDate - Find Your Perfect Match</title>
    <script>
      // Build timestamp for verification
      window.BUILD_TIMESTAMP = new Date().toISOString();
      console.log('ðŸ—ï¸ Build Timestamp:', window.BUILD_TIMESTAMP);
      
      // CRITICAL: Must run BEFORE any module loads
      // Polyfills for axios, simple-peer and Node.js globals
      (function() {
        'use strict';
        
        // Initialize globalThis
        if (typeof globalThis === 'undefined') {
          window.globalThis = window;
        }
        
        // Set up global object - CRITICAL
        if (!window.global) window.global = window;
        if (!globalThis.global) globalThis.global = globalThis;
        
        // Process polyfill - CRITICAL for axios
        if (typeof window.process === 'undefined') {
          window.process = { 
            env: { NODE_ENV: 'production' },
            browser: true,
            version: '',
            versions: {},
            nextTick: function(fn) { setTimeout(fn, 0); }
          };
        }
        global.process = window.process;
        globalThis.process = window.process;
        
        // Buffer polyfill
        if (typeof window.Buffer === 'undefined') {
          window.Buffer = { 
            isBuffer: function() { return false; }
          };
        }
        global.Buffer = window.Buffer;
        globalThis.Buffer = window.Buffer;
        
        // CRITICAL: Ensure Request/Response/fetch are ALWAYS available
        // This prevents axios "Cannot destructure property 'Request' of 'undefined'" error
        
        // Use native Request or create fallback
        if (!window.Request) {
          window.Request = class Request {
            constructor(input, init) {
              this.url = input;
              this.method = (init && init.method) || 'GET';
              this.headers = (init && init.headers) || {};
              this.body = (init && init.body) || null;
            }
          };
        }
        
        // Use native Response or create fallback
        if (!window.Response) {
          window.Response = class Response {
            constructor(body, init) {
              this.body = body;
              this.status = (init && init.status) || 200;
              this.statusText = (init && init.statusText) || 'OK';
              this.headers = (init && init.headers) || {};
              this.ok = this.status >= 200 && this.status < 300;
            }
            json() { return Promise.resolve(JSON.parse(this.body)); }
            text() { return Promise.resolve(String(this.body)); }
          };
        }
        
        // Use native fetch or create fallback
        if (!window.fetch) {
          window.fetch = function() {
            return Promise.reject(new Error('Fetch API not available'));
          };
        }
        
        // Expose on ALL global objects for maximum compatibility
        global.Request = window.Request;
        global.Response = window.Response;
        global.fetch = window.fetch;
        globalThis.Request = window.Request;
        globalThis.Response = window.Response;
        globalThis.fetch = window.fetch;
        
        // Also expose on self for web workers
        if (typeof self !== 'undefined') {
          self.Request = window.Request;
          self.Response = window.Response;
          self.fetch = window.fetch;
        }
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
